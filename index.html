<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Upside Down | An Exercise in Unlearning North</title>
<meta name="description" content="The first photo of Earth had south on top. NASA flipped it. This map flips it back." />

<!-- Open Graph -->
<meta property="og:type" content="website" />
<meta property="og:title" content="Upside Down | An Exercise in Unlearning North" />
<meta property="og:description" content="The first photo of Earth had south on top. NASA flipped it. This map flips it back." />
<meta property="og:image" content="/og-image.png" />
<meta property="og:url" content="https://world-upside-down.vercel.app" />

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Upside Down | An Exercise in Unlearning North" />
<meta name="twitter:description" content="The first photo of Earth had south on top. NASA flipped it. This map flips it back." />
<meta name="twitter:image" content="/og-image.png" />

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Inter:wght@300;400;500&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/src/landing.css" />
</head>
<body>

<!-- ── Ink registration strip — 5 drums ── -->
<div class="ink-strip" aria-hidden="true">
  <div class="ink-strip-swatch" style="background: #000000"></div>
  <div class="ink-strip-swatch" style="background: #88898A"></div>
  <div class="ink-strip-swatch" style="background: #00838A"></div>
  <div class="ink-strip-swatch" style="background: #0078BF"></div>
  <div class="ink-strip-swatch" style="background: #FF48B0"></div>
  <span class="ink-strip-label">5-DRUM RISO &middot; 150 DPI &middot; UNCOATED STOCK</span>
</div>

<!-- ── Visible grid overlay ── -->
<div class="grid-overlay" aria-hidden="true"></div>

<!-- ── Grain overlay ── -->
<div class="page-grain" aria-hidden="true"></div>

<!-- ==========================================
     HERO — Typography + Stochastic halftone
     ========================================== -->
<section class="hero" id="hero">
  <canvas class="hero-halftone" id="hero-halftone" aria-hidden="true"></canvas>

  <div class="page-grid hero-grid">
    <div class="hero-masthead">
      <span class="masthead-name">Upside <span class="masthead-flipped">Down</span></span>
    </div>

    <div class="hero-meta meta">
      <span>51.5464&deg; N, 0.0554&deg; W</span>
      <span>2026.02</span>
      <span>Edition 001</span>
    </div>

    <h1 class="hero-title display-xl" data-text="An Exercise
in Unlearning
North.">
      An Exercise<br>in Unlearning<br>North.
    </h1>

    <p class="hero-subtitle">A cartographic provocation</p>

    <div class="hero-actions">
      <a href="/map" class="hero-launch">Launch the Map</a>
      <a href="#map-section" class="hero-scroll-link">or scroll to preview</a>
    </div>

    <a href="#map-section" class="scroll-indicator">
      <div class="scroll-line"></div>
    </a>
  </div>
</section>

<!-- ── Divider ── -->
<div class="section-divider"></div>

<!-- ==========================================
     MAP PREVIEW — Framed within the grid
     ========================================== -->
<section class="map-section" id="map-section">
  <div class="page-grid">
    <a href="/map" class="map-enter meta link-underline">Enter the Map &rarr;</a>

    <div class="map-frame">
      <iframe id="map-iframe" src="/map#11/51.507/-0.128/180" frameborder="0" allow="fullscreen" loading="lazy"></iframe>
      <div class="map-shield"></div>
    </div>

    <div class="map-meta-bar">
      <div class="pink-accent-line"></div>
      <div class="map-meta meta">
        <span>Mercator</span>
        <span>Bearing 180&deg;</span>
        <span>South-Up</span>
        <span>z11</span>
      </div>
    </div>
  </div>
</section>

<!-- ── Divider ── -->
<div class="section-divider"></div>

<!-- ==========================================
     PROVOCATION — Quote + Body + Data Block
     ========================================== -->
<section class="provocation-section" id="provocation">
  <div class="page-grid">
    <blockquote class="provocation-quote heading-lg reveal">
      <div class="quote-accent-bar"></div>
      &ldquo;Every world map is a political statement. This one just admits it.&rdquo;
    </blockquote>

    <div class="provocation-body body reveal reveal-d1">
      <p>
        In 1972, the Apollo 17 crew captured the most iconic photograph of Earth: the Blue Marble.
        In the original, the southern tip of Africa pointed upward. Before releasing it,
        NASA rotated the image 180&deg; to match the convention that north belongs on top.
      </p>
      <p>
        They literally turned the planet upside down to make it look &ldquo;right.&rdquo;
      </p>
      <p>
        This project flips it back. The map loads at bearing 180&deg;. South is up.
        Your city looks unfamiliar. Your country is in the wrong place.
        That discomfort is the point.
      </p>
    </div>

    <div class="data-block reveal reveal-d2">
      <div class="data-block-title meta">Mercator Distortion</div>
      <div class="data-row">
        <span class="data-label">Africa</span>
        <span class="data-value">30.4M km&sup2;</span>
      </div>
      <div class="data-row">
        <span class="data-label">Greenland</span>
        <span class="data-value">2.2M km&sup2;</span>
      </div>
      <div class="data-row">
        <span class="data-label">Mercator Ratio</span>
        <span class="data-value">1:1.8</span>
      </div>
      <div class="data-row">
        <span class="data-label">True Ratio</span>
        <span class="data-value">1:14</span>
      </div>
    </div>
  </div>
</section>

<!-- ── Divider ── -->
<div class="section-divider"></div>

<!-- ==========================================
     BLUE MARBLE SCANDAL
     ========================================== -->
<section class="marble-section" id="scandal">
  <div class="page-grid">
    <div class="section-header">
      <span class="meta reveal">The Blue Marble Scandal</span>
      <h2 class="heading-lg reveal reveal-d1">The first photograph of Earth had south on top. NASA flipped it.</h2>
    </div>

    <div class="marble-pair reveal reveal-d2">
      <div class="marble-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/3/39/The_Earth_seen_from_Apollo_17_%28Original_Orientation%29.jpg" alt="Blue Marble original orientation, south on top" class="marble-img" loading="lazy" />
        <span class="meta">Original photograph</span>
      </div>
      <div class="marble-arrow" aria-hidden="true">&#x27F3;</div>
      <div class="marble-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/c/cb/The_Blue_Marble_%28remastered%29.jpg" alt="Blue Marble NASA version, north on top" class="marble-img marble-flipped" loading="lazy" />
        <span class="meta">&ldquo;Corrected&rdquo; by NASA</span>
      </div>
    </div>
  </div>
</section>

<!-- ── Divider ── -->
<div class="section-divider"></div>

<!-- ==========================================
     TORRES GARC&Iacute;A QUOTE
     ========================================== -->
<section class="torres-section">
  <div class="page-grid">
    <div class="torres-layout">
      <img src="https://upload.wikimedia.org/wikipedia/commons/0/0d/Joaqu%C3%ADn_Torres_Garc%C3%ADa_-_Am%C3%A9rica_Invertida.jpg" alt="Am&eacute;rica Invertida by Torres Garc&iacute;a, 1943" class="torres-img reveal" loading="lazy" />
      <blockquote class="torres-quote reveal reveal-d1">
        <p class="heading-lg">&ldquo;Nuestro norte es el Sur.&rdquo;</p>
        <p class="body quote-translation">&ldquo;Our north is the South. There should be no north for us, except in opposition to our South.
        That is why we now turn the map upside down.&rdquo;</p>
        <cite class="meta">Joaqu&iacute;n Torres Garc&iacute;a &middot; Universalismo Constructivo &middot; 1935</cite>
      </blockquote>
    </div>
  </div>
</section>

<!-- ── Divider ── -->
<div class="section-divider"></div>

<!-- ==========================================
     COUNTER-CARTOGRAPHY ARTISTS
     ========================================== -->
<section class="artists-section" id="artists">
  <div class="page-grid">
    <div class="section-header">
      <span class="meta reveal">Counter-Cartographies</span>
      <h2 class="heading-lg reveal reveal-d1">Artists &amp; architects who flipped the script</h2>
    </div>
  </div>

  <div class="artists-grid page-grid">
    <div class="artist-card reveal" data-pattern="grid" data-ink="teal">
      <canvas class="card-pattern" aria-hidden="true"></canvas>
      <img src="https://upload.wikimedia.org/wikipedia/commons/0/0d/Joaqu%C3%ADn_Torres_Garc%C3%ADa_-_Am%C3%A9rica_Invertida.jpg" alt="Am&eacute;rica Invertida" class="artist-thumb" loading="lazy" />
      <h3 class="heading-sm">Joaqu&iacute;n Torres Garc&iacute;a</h3>
      <div class="artist-meta meta">Uruguay &middot; 1943</div>
      <p class="body">Drew South America upside down as a decolonial manifesto. &ldquo;Our north is the south&rdquo; became a rallying cry for Latin American cultural autonomy.</p>
      <div class="artist-work meta">Am&eacute;rica Invertida</div>
    </div>

    <div class="artist-card reveal reveal-d1" data-pattern="stochastic" data-ink="blue">
      <canvas class="card-pattern" aria-hidden="true"></canvas>
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Hatoum%2C_Hot_Spot_III%2C_2009.jpg/640px-Mona_Hatoum%2C_Hot_Spot_III%2C_2009.jpg" alt="Hot Spot III by Mona Hatoum" class="artist-thumb" loading="lazy" />
      <h3 class="heading-sm">Mona Hatoum</h3>
      <div class="artist-meta meta">Palestine / UK &middot; 2006</div>
      <p class="body">Maps made from soap with glass beads. A glowing neon globe where every continent is a hot spot. Territory as fragile material. Geography as violence.</p>
      <div class="artist-work meta">Present Tense &amp; Hot Spot</div>
    </div>

    <div class="artist-card reveal reveal-d2" data-pattern="diamond" data-ink="teal">
      <canvas class="card-pattern" aria-hidden="true"></canvas>
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Dymaxion_map_unfolded.png/640px-Dymaxion_map_unfolded.png" alt="Dymaxion Map by Buckminster Fuller" class="artist-thumb" loading="lazy" />
      <h3 class="heading-sm">Buckminster Fuller</h3>
      <div class="artist-meta meta">USA &middot; 1943</div>
      <p class="body">Unfolded the globe into a flat surface with no right way up. No country is at the top. No country is at the bottom. The whole thing can be rearranged.</p>
      <div class="artist-work meta">Dymaxion Map</div>
    </div>

    <div class="artist-card reveal" data-pattern="horizontal" data-ink="black">
      <canvas class="card-pattern" aria-hidden="true"></canvas>
      <img src="https://upload.wikimedia.org/wikipedia/en/0/0a/William_Kentridge_Drawing_from_Stereoscope.jpg" alt="Drawing for Projection by William Kentridge" class="artist-thumb" loading="lazy" />
      <h3 class="heading-sm">William Kentridge</h3>
      <div class="artist-meta meta">South Africa &middot; 1989</div>
      <p class="body">Animated charcoal drawings where maps of Johannesburg dissolve and redraw themselves. Colonial borders erased and redrawn in real time.</p>
      <div class="artist-work meta">Drawings for Projection</div>
    </div>

    <div class="artist-card reveal reveal-d1" data-pattern="reaction" data-ink="blue">
      <canvas class="card-pattern" aria-hidden="true"></canvas>
      <img src="https://upload.wikimedia.org/wikipedia/en/8/84/%C3%96yvind_Fahlstr%C3%B6m_World_Map.jpg" alt="World Map by &Ouml;yvind Fahlstr&ouml;m" class="artist-thumb" loading="lazy" />
      <h3 class="heading-sm">&Ouml;yvind Fahlstr&ouml;m</h3>
      <div class="artist-meta meta">Sweden / Brazil &middot; 1972</div>
      <p class="body">Painted world maps with moveable magnetic pieces. Viewers could rearrange countries, rewrite borders, redistribute power. The map was never finished.</p>
      <div class="artist-work meta">World Map</div>
    </div>

    <div class="artist-card reveal reveal-d2" data-pattern="concentric" data-ink="teal">
      <canvas class="card-pattern" aria-hidden="true"></canvas>
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/McArthurs_Universal_Corrective_Map_of_the_World.jpg/640px-McArthurs_Universal_Corrective_Map_of_the_World.jpg" alt="McArthur's Universal Corrective Map" class="artist-thumb" loading="lazy" />
      <h3 class="heading-sm">Stuart McArthur</h3>
      <div class="artist-meta meta">Australia &middot; 1979</div>
      <p class="body">At 21, published the Universal Corrective Map of the World on Australia Day. South on top. 350,000 copies sold. The best-selling south-up map in history. Proof that one stubborn Australian can shift a paradigm.</p>
      <div class="artist-work meta">Universal Corrective Map</div>
    </div>
  </div>
</section>

<!-- ── Divider ── -->
<div class="section-divider"></div>

<!-- ==========================================
     PSYCHOLOGY / IDIOMS
     ========================================== -->
<section class="psych-section" id="psychology">
  <div class="page-grid">
    <div class="psych-header">
      <span class="meta reveal">The Psychology</span>
      <h2 class="heading-lg reveal reveal-d1">When we say things &ldquo;went south,&rdquo; we mean they went wrong.</h2>
    </div>

    <div class="psych-body body reveal reveal-d2">
      <p>
        Research shows that people associate north positions on maps with wealth, prestige, and higher altitude,
        while south positions are linked to poverty and lower status. The critical finding:
        when participants were shown south-up maps, this bias completely disappeared.
      </p>
    </div>

    <ul class="idiom-list reveal reveal-d2">
      <li>&ldquo;Heading <strong>up</strong> north&rdquo; <span class="idiom-meaning meta">&rarr; going somewhere better</span></li>
      <li>&ldquo;Going <strong>down</strong> south&rdquo; <span class="idiom-meaning meta">&rarr; going somewhere lesser</span></li>
      <li>&ldquo;<strong>Down Under</strong>&rdquo; <span class="idiom-meaning meta">&rarr; under what, exactly? Under whose map?</span></li>
      <li>&ldquo;<strong>Top</strong> of the world&rdquo; <span class="idiom-meaning meta">&rarr; success, power, achievement</span></li>
      <li>&ldquo;Things went <strong>south</strong>&rdquo; <span class="idiom-meaning meta">&rarr; things went wrong</span></li>
      <li>&ldquo;<strong>Developing</strong> world&rdquo; <span class="idiom-meaning meta">&rarr; almost always south of the equator</span></li>
    </ul>
  </div>
</section>

<!-- ── Divider ── -->
<div class="section-divider"></div>

<!-- ==========================================
     CTA
     ========================================== -->
<section class="cta-section" id="cta">
  <div class="page-grid">
    <h2 class="cta-title display-xl reveal" data-text="Flip your
world.">Flip your<br>world.</h2>

    <p class="cta-body body reveal reveal-d1">
      This map loads at bearing 180&deg;. South is up. Your city looks unfamiliar.
      Your country is in the wrong place. Press the arrow keys and the world snaps
      back to &ldquo;normal.&rdquo; But now you know: normal is just a convention.
      And conventions can be changed.
    </p>

    <a href="/map" class="cta-button reveal reveal-d2">Launch the Map &#x27F3;</a>
  </div>
</section>

<!-- ── Divider ── -->
<div class="section-divider"></div>

<!-- ==========================================
     COLOPHON
     ========================================== -->
<footer class="colophon">
  <div class="page-grid">
    <div class="colophon-header meta">Colophon</div>

    <div class="colophon-block">
      <div class="colophon-col">
        <span class="data-label">Built With</span>
        <span class="data-value">MapLibre GL JS</span>
        <span class="data-value">D3.js</span>
        <span class="data-value">PMTiles</span>
        <span class="data-value">Natural Earth</span>
      </div>
      <div class="colophon-col">
        <span class="data-label">Author</span>
        <span class="data-value">Gerardo Mart&iacute;n Carre&ntilde;o</span>
        <span class="meta">Spatial Data Scientist</span>
      </div>
    </div>

    <div class="colophon-block">
      <div class="colophon-col">
        <span class="data-label">Projection</span>
        <span class="data-value">Mercator (bearing 180&deg;)</span>
        <span class="data-value">Airocean (Dymaxion)</span>
      </div>
      <div class="colophon-col">
        <span class="data-label">Ink System</span>
        <div class="ink-row"><div class="ink-swatch" style="--swatch: #000000"></div><span class="meta">Black &middot; Pantone Black U</span></div>
        <div class="ink-row"><div class="ink-swatch" style="--swatch: #00838A"></div><span class="meta">Teal &middot; Pantone 321 U</span></div>
        <div class="ink-row"><div class="ink-swatch" style="--swatch: #0078BF"></div><span class="meta">Blue &middot; Pantone 3005 U</span></div>
        <div class="ink-row"><div class="ink-swatch" style="--swatch: #FF48B0"></div><span class="meta">Fluor Pink &middot; 806 U</span></div>
        <div class="ink-row"><div class="ink-swatch" style="--swatch: #88898A"></div><span class="meta">Light Gray &middot; 424 U</span></div>
      </div>
    </div>

    <div class="colophon-block">
      <div class="colophon-col">
        <span class="data-label">Typefaces</span>
        <span class="data-value">Space Grotesk</span>
        <span class="data-value">Inter</span>
        <span class="data-value">JetBrains Mono</span>
      </div>
      <div class="colophon-col">
        <span class="data-label">Paper</span>
        <div class="ink-row"><div class="ink-swatch" style="--swatch: #F2EDE4"></div><span class="data-value">#F2EDE4</span></div>
        <span class="meta">Warm uncoated stock</span>
      </div>
    </div>

    <div class="colophon-footer">
      <p class="meta">Upside Down &middot; A project by Gerardo Mart&iacute;n Carre&ntilde;o &middot; 2026</p>
      <p class="meta">Built with love from Clapton, East London, a place that looks different at bearing 180&deg;</p>
      <a href="https://www.linkedin.com/in/gerardoezequielmc/" target="_blank" rel="noopener" class="linkedin-link">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
        <span>Connect on LinkedIn</span>
      </a>
    </div>
  </div>
</footer>

<script type="module" src="/src/analytics.ts"></script>
<script>
(function() {
  'use strict';

  /* ══════════════════════════════════════
     REACTION-DIFFUSION HALFTONE — Hero background
     Blue metaball pattern on hex grid, dense at bottom
     ══════════════════════════════════════ */

  function generateHeroHalftone() {
    var canvas = document.getElementById('hero-halftone');
    if (!canvas) return;
    var ctx = canvas.getContext('2d');

    // Size canvas to hero
    var hero = canvas.parentElement;
    var dpr = Math.min(window.devicePixelRatio || 1, 2);
    var w = hero.offsetWidth;
    var h = hero.offsetHeight;
    canvas.width = w * dpr;
    canvas.height = h * dpr;
    canvas.style.width = w + 'px';
    canvas.style.height = h + 'px';
    ctx.scale(dpr, dpr);

    // ── 2D value noise (hash-based) ──
    function hash2d(ix, iy) {
      var n = Math.sin(ix * 127.1 + iy * 311.7) * 43758.5453;
      return n - Math.floor(n);
    }

    function smoothNoise(x, y) {
      var ix = Math.floor(x), iy = Math.floor(y);
      var fx = x - ix, fy = y - iy;
      // Smoothstep interpolation
      fx = fx * fx * (3 - 2 * fx);
      fy = fy * fy * (3 - 2 * fy);
      var a = hash2d(ix, iy), b = hash2d(ix + 1, iy);
      var c = hash2d(ix, iy + 1), d = hash2d(ix + 1, iy + 1);
      return a + (b - a) * fx + (c - a) * fy + (a - b - c + d) * fx * fy;
    }

    // Fractal Brownian Motion — 4 octaves
    function fbm(x, y) {
      var val = 0, amp = 0.5;
      for (var o = 0; o < 4; o++) {
        val += amp * smoothNoise(x, y);
        x *= 2.0; y *= 2.0; amp *= 0.5;
      }
      return val;
    }

    // ── Build hex-grid dots with noise-modulated sizes ──
    var INK = '#0078BF'; // Riso blue
    var spacing = 14;
    var rowH = spacing * 0.866; // sin(60°)
    var freq = 0.022; // noise frequency — controls blob size
    var dots = [];

    for (var row = -1; row * rowH < h + spacing; row++) {
      var yPos = row * rowH;
      var xOff = (row % 2) ? spacing * 0.5 : 0;

      for (var col = -1; col * spacing < w + spacing; col++) {
        var xPos = col * spacing + xOff;

        // Fractal noise for organic blobs
        var n = fbm(xPos * freq, yPos * freq);

        // Y gradient: pattern starts at ~35% from top, dense at bottom
        var yNorm = yPos / h;
        var gradStart = 0.30;
        var yDensity = Math.max(0, (yNorm - gradStart) / (1 - gradStart));
        yDensity = yDensity * yDensity; // ease-in curve

        // Combine noise + gradient
        var combined = n * 0.55 + yDensity * 0.50;

        // Threshold — below this, no dot
        var threshold = 0.30;
        if (combined > threshold) {
          var t = (combined - threshold) / (1 - threshold);
          // Radius grows with intensity — large enough to merge with neighbors
          var radius = 1.5 + t * (spacing * 0.52);
          dots.push({ x: xPos, y: yPos, r: radius });
        }
      }
    }

    // ── Animate: sweep reveal from bottom to top over 1.5s ──
    // Sort dots by y descending (bottom first)
    dots.sort(function(a, b) { return b.y - a.y; });

    var totalFrames = 90; // ~1.5s at 60fps
    var dotsPerFrame = Math.ceil(dots.length / totalFrames);
    var drawn = 0;

    ctx.fillStyle = INK;
    ctx.globalAlpha = 1;

    function drawBatch() {
      var end = Math.min(drawn + dotsPerFrame, dots.length);

      for (var k = drawn; k < end; k++) {
        var dot = dots[k];
        ctx.beginPath();
        ctx.arc(dot.x, dot.y, dot.r, 0, Math.PI * 2);
        ctx.fill();
      }

      drawn = end;
      if (drawn < dots.length) {
        requestAnimationFrame(drawBatch);
      }
    }

    requestAnimationFrame(drawBatch);
  }

  /* ══════════════════════════════════════
     CARD HALFTONE PATTERNS
     ══════════════════════════════════════ */

  var INK_COLORS = {
    teal:  '#00838A',
    blue:  '#0078BF',
    black: '#000000'
  };

  function drawCardPattern(canvas, patternType, inkColor) {
    if (!canvas || !canvas.getContext) return;
    var ctx = canvas.getContext('2d');
    var w = canvas.parentElement.offsetWidth;
    var h = canvas.parentElement.offsetHeight;
    var dpr = Math.min(window.devicePixelRatio || 1, 2);
    canvas.width = w * dpr;
    canvas.height = h * dpr;
    canvas.style.width = w + 'px';
    canvas.style.height = h + 'px';
    ctx.scale(dpr, dpr);

    ctx.fillStyle = inkColor;
    ctx.strokeStyle = inkColor;

    switch (patternType) {
      case 'grid':
        for (var x = 4; x < w; x += 8) {
          for (var y = 4; y < h; y += 8) {
            ctx.beginPath();
            ctx.arc(x, y, 1.2, 0, Math.PI * 2);
            ctx.fill();
          }
        }
        break;

      case 'stochastic':
        var count = Math.floor(w * h * 0.002);
        for (var i = 0; i < count; i++) {
          ctx.beginPath();
          ctx.arc(
            Math.random() * w,
            Math.random() * h,
            0.8 + Math.random() * 1.2,
            0, Math.PI * 2
          );
          ctx.fill();
        }
        break;

      case 'diamond':
        ctx.save();
        ctx.translate(w / 2, h / 2);
        ctx.rotate(Math.PI / 4);
        ctx.translate(-w, -h);
        for (var dx = 0; dx < w * 2; dx += 7) {
          for (var dy = 0; dy < h * 2; dy += 7) {
            ctx.fillRect(dx, dy, 2, 2);
          }
        }
        ctx.restore();
        break;

      case 'horizontal':
        ctx.lineWidth = 0.5;
        for (var hy = 0; hy < h; hy += 4) {
          ctx.beginPath();
          ctx.moveTo(0, hy);
          ctx.lineTo(w, hy);
          ctx.stroke();
        }
        break;

      case 'reaction':
        var centers = [];
        for (var c = 0; c < 15; c++) {
          centers.push({
            x: Math.random() * w,
            y: Math.random() * h,
            r: 10 + Math.random() * 20
          });
        }
        for (var ci = 0; ci < centers.length; ci++) {
          var ctr = centers[ci];
          for (var rj = 0; rj < 20; rj++) {
            var angle = Math.random() * Math.PI * 2;
            var dist = Math.random() * ctr.r;
            ctx.beginPath();
            ctx.arc(
              ctr.x + Math.cos(angle) * dist,
              ctr.y + Math.sin(angle) * dist,
              1.5 + Math.random(),
              0, Math.PI * 2
            );
            ctx.fill();
          }
        }
        break;

      case 'concentric':
        var cx = w / 2;
        var cy = h / 2;
        ctx.lineWidth = 0.5;
        for (var cr = 5; cr < Math.max(w, h); cr += 8) {
          ctx.beginPath();
          ctx.arc(cx, cy, cr, 0, Math.PI * 2);
          ctx.stroke();
        }
        break;
    }
  }

  function initCardPatterns() {
    var cards = document.querySelectorAll('.artist-card');
    cards.forEach(function(card) {
      var canvas = card.querySelector('.card-pattern');
      var pattern = card.getAttribute('data-pattern');
      var inkKey = card.getAttribute('data-ink') || 'teal';
      var color = INK_COLORS[inkKey] || INK_COLORS.teal;
      drawCardPattern(canvas, pattern, color);
    });
  }

  /* ══════════════════════════════════════
     SCROLL REVEAL
     ══════════════════════════════════════ */

  function initScrollReveal() {
    var observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.15, rootMargin: '0px 0px -40px 0px' });

    document.querySelectorAll('.reveal').forEach(function(el) {
      observer.observe(el);
    });
  }

  /* ══════════════════════════════════════
     BLUE MARBLE FLIP ANIMATION
     ══════════════════════════════════════ */

  function initMarbleFlip() {
    var marble = document.querySelector('.marble-flipped');
    if (!marble) return;

    var observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          marble.classList.add('do-flip');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });

    observer.observe(marble);
  }

  /* ══════════════════════════════════════
     IDIOM STAGGER ANIMATION
     ══════════════════════════════════════ */

  function initIdiomAnimation() {
    var list = document.querySelector('.idiom-list');
    if (!list) return;

    var observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          var items = entry.target.querySelectorAll('li');
          items.forEach(function(li, i) {
            setTimeout(function() {
              li.classList.add('idiom-visible');
            }, i * 150);
          });
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });

    observer.observe(list);
  }

  /* ══════════════════════════════════════
     MAP SHIELD — Click to interact, mouse-leave to re-shield
     ══════════════════════════════════════ */

  function initMapShield() {
    var shield = document.querySelector('.map-shield');
    var frame = document.querySelector('.map-frame');
    if (!shield || !frame) return;

    shield.addEventListener('click', function() {
      shield.style.display = 'none';
    });

    frame.addEventListener('mouseleave', function() {
      shield.style.display = '';
    });
  }

  /* ══════════════════════════════════════
     MARBLE ARROW SCROLL ROTATION
     ══════════════════════════════════════ */

  function initScrollEffects() {
    var arrow = document.querySelector('.marble-arrow');
    var ticking = false;

    window.addEventListener('scroll', function() {
      if (!ticking) {
        requestAnimationFrame(function() {
          if (arrow) {
            arrow.style.transform = 'rotate(' + (window.scrollY * 0.3) + 'deg)';
          }
          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });
  }

  /* ══════════════════════════════════════
     INIT
     ══════════════════════════════════════ */

  function init() {
    generateHeroHalftone();
    initCardPatterns();
    initScrollReveal();
    initMarbleFlip();
    initIdiomAnimation();
    initMapShield();
    initScrollEffects();
  }

  // Run when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }

  // Re-render canvases on resize
  var resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function() {
      generateHeroHalftone();
      initCardPatterns();
    }, 250);
  });

})();
</script>
</body>
</html>
